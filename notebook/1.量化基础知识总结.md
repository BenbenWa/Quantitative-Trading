# 基本模型



 ![量化基础知识01](https://github.com/Miya-Su/Quantitative-Trading/tree/miya/image/量化基础知识01.png)

根据现代金融理论的定义，投资组合获取的收益均可以分为两个部分，一部分是来自市场的收益也就是𝐵𝑒𝑡𝑎，另一部分则是超出市场的收益也就是我们常说的𝐴𝑙𝑝ℎ𝑎。

如何准确的定义和寻找股票市场中的𝐴𝑙𝑝ℎ𝑎一直是学术界和业 界不断探索的问题，已有的模型包括资本资产定价模型 CAPM 和APT、 Fama-French 三因素模型等，而多因子模型正是基于套利定价理论（APT） 而建立的更为完善的定价模型。 

## CAMP

资本资产定价模型（CAPM）由威廉·夏普等人于 1964 年提出，CAPM 模 型是在资产组合理论的基础上发展起来的：
$$
𝐸(𝑟𝑝) = 𝑟𝐹 +𝛽𝑝 ∗(𝑟𝑀 −𝑟𝐹)
$$
 其中，𝑟𝑝代表资产 p 的收益率，𝑟𝐹代表无风险收益率，𝑟𝑀代表市场基准收益 率。 

在 CAPM 模型的定义下，资产的收益率只与𝛽𝑝有关，这里的𝛽𝑝则定义为：
$$
𝛽𝑝 = 𝐶𝑜𝑣(𝑟𝑝,𝑟𝑀) 𝑉𝑎𝑟(𝑟𝑀)
$$
即资产收益率与市场组合收益率之间的协方差除以市场组合收益率方差,因此我们可以将 CAPM 模型看作以市场组合为因子的单因子 模型。 



## APT

套利定价模型，是一种资产价格的估值模型，是[资本资产定价模型](https://baike.baidu.com/item/%E8%B5%84%E6%9C%AC%E8%B5%84%E4%BA%A7%E5%AE%9A%E4%BB%B7%E6%A8%A1%E5%9E%8B/10867338)（CAPM）的替代理论。虽然被称作套利定价模型，但实际与套利交易无关，是适用于所有资产的估值模型，其理论基础是一项资产的价格是由不同因素驱动，将这些因素乘上该因素对资产价格影响的[贝塔](https://baike.baidu.com/item/%E8%B4%9D%E5%A1%94)系数，加总后，再加上[无风险收益率](https://baike.baidu.com/item/%E6%97%A0%E9%A3%8E%E9%99%A9%E6%94%B6%E7%9B%8A%E7%8E%87)，就可以得出该项资产的价值。

### 套利

套利也叫价差交易，套利指的是在买入或卖出某种电子交易合约的同时，卖出或买入相关的另一种合约。

套利交易是指利用相关市场或相关电子合同之间的价差变化，在相关市场或相关电子合同上进行交易方向相反的交易，以期望价差发生变化而获利的交易行为。

由于套利的存在，即两个约当物品或证券的价格不一致时，必然发生高价卖出，同时低价买入的行为，最终使约当物品或证券的价格相同而达于均衡。罗斯根据这一原理，导出在无套利的价格均衡情况下应有的投资组合。

| 套利                                                         | 无套利                                                       |
| ------------------------------------------------------------ | ------------------------------------------------------------ |
| 存在一个交易策略,满足以下4个条件:                                                                                                           1)不需要任何投入,自我融资(self-financing)   *l**w**A* = 0　                                                                                           2)对所有因素风险完全免疫*B**w**A* = 0                                                                                                                                        3)对所有非因素风险完全免疫                                                                                                                                  4)当资产数目足够多时,期末可以获得无风险收益 | 在[市场均衡](https://baike.baidu.com/item/%E5%B8%82%E5%9C%BA%E5%9D%87%E8%A1%A1)时刻，不存在任何套利机会 |

### APT原理

套利价格理论APT模型是由A·罗斯首创的一种决定资产价格的均衡模型，用来研究证券价格是如何决定的。

它假设证券的收益是由一系列产业方面和市场方面的因素确定的。当两种证券的收益受到某种或某些因素的影响时，两种证券收益之间就存在相关性。

套利定价理论的基本机制是：在给定资产收益率计算公式的条件下，根据套利原理推导出资产的价格和均衡关系式。

该套利价格理论隐含如下几项假设：①影响证券收益率的因素不止一个，而是m个有限因素; ②资本市场是完全竞争市场; ③实行多元化组合投资，可消除只影响单一证券的非系统风险; ④投资者属于风险规避类型。

套利定价理论（APT）则为多因子模型提供了理论基础，APT 模型用多个因子来解释资产收益，并且根据无套利原则，得到风险资产均衡收益与多个因 子之间存在近似线性关系，从而将影响资产收益的因子从 CAPM 的单因子或 Fama-French 的三因子拓展到多个因子，也就为多因子模型的发展奠定了基础。



### APT和CAPM

1.套利定价理论APT(Arbitrage Pricing Theory) 是[CAPM](https://baike.baidu.com/item/CAPM)的拓广，由APT给出的定价模型与CAPM一样，都是均衡状态下的模型，不同的是APT的基础是因素模型。

2.APT没有给出都是哪些因素驱动资产价格，这些因素可能数量众多，只能凭投资者经验自行判断选择，此外每项因素都要计算相应的[贝塔值](https://baike.baidu.com/item/%E8%B4%9D%E5%A1%94%E5%80%BC)，而CAPM模型只需计算一个贝塔值，所以在对资产价格估值的实际应用时，CAPM比APT使用地更广泛。

3.APT中，资本资产的收益率（也就是期望风险溢价）是GDP增长、通货膨胀水平等各种因素综合作用的结果，并不仅仅受Rm-Rf的影响，也就是说APT是多因素的。

4.APT与CAPM的另一个主要区别就是假设不同：CAPM的假设是马科维茨，主要是最优投资组合和市场均衡，而APT的是因子模型与市场无套利，假设数量相对较少。

5.CAPM是从投资者如何构建有效投资组合的分析开始的，但APT却不再分析投资组合是否有效，而是假设每只股票的收益受两种影响：第一种是宏观经济形势的影响，或者说是一些因子（factors），而第二种是与公司相关的独特事件的影响，也就是噪音（noise）。APT则套用风险资产的预期收益率和各宏观经济因素的风险溢价。套利者使用APT模型，利用证券的错误定价从中取利。当证券出现错误定价，其价格将异于从理论模式预测出来的价格。



## MFM

基于 APT 理论的多因子模型（MFM） 。
股票二级市场的多因子模型也同样可以理解为将N只股票的收益率分解为M 个因子的线性组合与未被因子解释的残差项。影响股票收益率的因素主要来 自某一只股票相对于某一个因子的敏感度或因子暴露（factor loading），这 里的因子暴露即相当于 CAPM 中的𝛽𝑝。 

 相比较 CAPM 和 Fama-French 等模型，多因子模型的优势在于它可以提供 更为完整的风险暴露分析，并且分离出每个因子的影响,从而为投资决策提供 更为局部和细致的分析。 

多因子定价模型(Multifactor Pricing Model)是CAPM与APT之后的延伸，是指APT后有具体因子出现的定价模型。FF的三因子五因子就是多因子模型中的代表。  



## Fama-French 三因子

但随着业界对股票市场研究的深入，CAPM 这样的单一因子模型已经无法很好的解释资产收益的来源。例如，Fama/French1在 1992 年提出 PB 和市值 因子对股票的收益率有十分显著的影响，并且基于这个发现建立了 Fama-French 三因素模型。

Fama French三因子模型是对CAPM模型的一个扩展。

CAPM模型认为：

（1）证券资产的预期收益和它的市场Beta之间存在一个正向的线性关系，Beta越大，资产的预期收益越大；（2）市场Beta足以解释证券资产的预期收益。

在CAPM的基础上增加了两个因子：规模因子SMB（size factor，也称市值因子）和账面市值比因子HML（book-to-market factor，也称价值因子）。他们认为，市场因子再加上这两个因子三者可以很好地持续地解释资产的平均收益。 

Fama和French 1993年指出可以建立一个三因子模型来解释股票[回报率](https://baike.baidu.com/item/%E5%9B%9E%E6%8A%A5%E7%8E%87)。模型认为，一个[投资组合](https://baike.baidu.com/item/%E6%8A%95%E8%B5%84%E7%BB%84%E5%90%88)(包括单个股票)的超额回报率可由它对三个因子的暴露来解释，这三个因子是：市场资产组合(*Rm*− *Rf*)、市值因子(SMB)、账面市值比因子(HML)。这个多因子均衡定价模型可以表示为：
$$
E(Rit) −Rft= βi[E(Rmt−Rft)] +siE(SMBt) +hiE(HMIt)
$$
其中*Rft*表示时间t的[无风险收益率](https://baike.baidu.com/item/%E6%97%A0%E9%A3%8E%E9%99%A9%E6%94%B6%E7%9B%8A%E7%8E%87)；*Rmt*表示时间t的[市场收益率](https://baike.baidu.com/item/%E5%B8%82%E5%9C%BA%E6%94%B6%E7%9B%8A%E7%8E%87)；*Rit*表示资产i在时间t的收益率；*E*(*R**mt*) − *Rft*是[市场风险](https://baike.baidu.com/item/%E5%B8%82%E5%9C%BA%E9%A3%8E%E9%99%A9)[溢价](https://baike.baidu.com/item/%E6%BA%A2%E4%BB%B7)，*SMBt*为时间t的[市值](https://baike.baidu.com/item/%E5%B8%82%E5%80%BC)(Size)因子的模拟组合收益率(Small minus Big)，*HMIt*为时间t的账面市值比(book—to—market)因子的模拟组合收益率(High minus Low)。

β、*si*和*hi*分别是三个因子的系数，回归模型表示如下：
$$
Rit− Rft= ai+ βi(Rmt− Rft) + siSMBt+ hiHMIt+ εit
$$
但是，我们应该看到，三因子模型并不代表资本定价模型的完结，在最近的研究发现，三因子模型中还有很多未被解释的部分，如短期反转、中期动量、波动、偏度、赌博等因素。

## Fama-French 五因子

 如果三因子模型中的三个因子可以完全解释各种风险带来的超额收益，那么任何一个股票以及任何一个投资组合的αi的真实值应该为0。在过去20年里面，很多学者对三因子模型进行实证分析，发现有些股票的αi显著不为0，这说明三因子模型中的三个风险（因素）并不能解释所有超额收益。后来，Fama和French发现在上述风险之外，还有盈利水平风险、投资水平风险也能带来个股的超额收益，并于2013年提出了五因子模型。该模型更加充分地解释个股的超额收益，其表达式为：
$$
𝑅𝑖=𝑎𝑖+𝑏𝑖𝑅𝑀+𝑠𝑖𝐸(𝑆𝑀𝐵)+ℎ𝑖𝐸(𝐻𝑀𝐼)+𝑟𝑖𝐸(𝑅𝑀𝑊)+𝑐𝑖𝐸(𝐶𝑀𝐴)+𝑒𝑖
$$
 从表达式看，五因子模型比三因子模型里面多出来了两项：E(RMW)是高/低盈利股票投资组合的回报之差，而E(CMA)则是低/高再投资比例公司股票投资组合的回报之差。这两项分别描述了盈利水平风险、投资水平风险（注意这里的投资水平不是二级市场的投资水平，而可以通俗的解释为企业扩大再生产的能力）。与三因子类似，参数估计的方法仍然是用多元线性回归的方法，这里的αi则是五因子模型里面尚未解释的超额收益。






# 多因子模型MFM

作为量化选股多因子𝐴𝑙𝑝ℎ𝑎模型构建环节中最重要的一部分，如何寻找具有逻辑支撑且能有效区分和预测股票收益的因子是主要内容。 

 ![量化基础知识02](https://github.com/Miya-Su/Quantitative-Trading/tree/miya/image/量化基础知识02.png)



大部分机构投资者主要研究Alpha模型，风险模型和组合优化采用外购商业软件（BARRA,Axioma等）



风险模型：任意股票同一时刻都暴露于多种不同的风险因素下，它们之间的共同作用形成了股票价格的波动，为了定量研究各种风险因素的作用，量化风险模型应运而生。

风险模型的意义在于找到股票价格波动的成因，并将股票收益来源进行剥离，并实行对未来股票波动价格的预测。

Alpha因子：是对股票收益率具有明显显著且稳定影响的某一变量，同时该影响是剔除其余所有因子对收益的作用而独立存在的。

“群众型”:更符合分散风险的量化投资基本原理，大型的Alpha因子库在提供多样的Alpha源的而同时，也带来了大量的无效和重复信息，会使得不同的Alpha源被人为的放大或缩小权重，最终影响组合表现。

对于一个新的因子，需要思考：是否提供了新的Alpha源？或只是把现有的因子库信息进行了切分重组？



对于因子相关性检验：IC协方差矩阵的估计（改进:压缩估计量、Boostrap方法）





## 量化投资

量化对冲策略目标：追求稳健的绝对收益，最优投资组合的构建是一种完美的平衡状态（充分暴露Alpha因子，同时剔除其余不稳定的风格因素干扰）。

市值中性、行业中性、风格中性的约束条件下的最优投资组合的构建。

|         行业中性: | 多头组合的行业配置与对冲基准的行业配置一致，目的在于剔除行业因子对策略收益的影响，仅考察行业内部个股的超额收益（行业中性策略的净值曲线往往比较平稳，回测较小） |
| ----------------: | ------------------------------------------------------------ |
| **风格因子中性:** | **多头组合的风格因子较之对冲基准的风险暴露为0，目的在于使多头组合的风格特征完全与对冲基准相匹配，使得组合的超额收益不是来自于某类风格** |



多因子模型：决定策略收益稳健性的关键步骤在于股票组合的权重配置。（组合权重优化）

