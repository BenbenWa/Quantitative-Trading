# 量化投资

 ![量化基础知识01](https://github.com/Miya-Su/Quantitative-Trading/tree/miya/image/量化基础知识01.png)

根据现代金融理论的定义，投资组合获取的收益均可以分为两个部分，一部分是来自市场的收益也就是𝐵𝑒𝑡𝑎，另一部分则是超出市场的收益也就是我们 常说的𝐴𝑙𝑝ℎ𝑎。

如何准确的定义和寻找股票市场中的𝐴𝑙𝑝ℎ𝑎一直是学术界和业 界不断探索的问题，已有的模型包括资本资产定价模型 CAPM 和 Fama-French 三因素模型等，而多因子模型正是基于套利定价理论（APT） 而建立的更为完善的定价模型。 

资本资产定价模型（CAPM）由威廉·夏普等人于 1964 年提出，CAPM 模 型是在资产组合理论的基础上发展起来的： 𝐸(𝑟𝑝) = 𝑟𝐹 +𝛽𝑝 ∗(𝑟𝑀 −𝑟𝐹)     其中，𝑟𝑝代表资产 p 的收益率，𝑟𝐹代表无风险收益率，𝑟𝑀代表市场基准收益 率。 在 CAPM 模型的定义下，资产的收益率只与𝛽𝑝有关，这里的𝛽𝑝则定义为： 𝛽𝑝 = 𝐶𝑜𝑣(𝑟𝑝,𝑟𝑀) 𝑉𝑎𝑟(𝑟𝑀) ，即资产收益率与市场组合收益率之间的协方差除以市场组 合收益率方差。因此我们可以将 CAPM 模型看作以市场组合为因子的单因子 模型。 

但随着业界对股票市场研究的深入，CAPM 这样的单一因子模型已经无法很 好的解释资产收益的来源。例如，Fama/French1在 1992 年提出 PB 和市值 因子对股票的收益率有十分显著的影响，并且基于这个发现建立了 Fama-French 三因素模型。 

套利定价理论（APT）则为多因子模型提供了理论基础。APT 模型用多个因 子来解释资产收益，并且根据无套利原则，得到风险资产均衡收益与多个因 子之间存在近似线性关系，从而将影响资产收益的因子从 CAPM 的单因子或 Fama-French 的三因子拓展到多个因子，也就为多因子模型的发展奠定了基础。

基于 APT 理论的多因子模型（MFM） 
股票二级市场的多因子模型也同样可以理解为将N只股票的收益率分解为M 个因子的线性组合与未被因子解释的残差项。影响股票收益率的因素主要来 自某一只股票相对于某一个因子的敏感度或因子暴露（factor loading），这 里的因子暴露即相当于 CAPM 中的𝛽𝑝。 

 相比较 CAPM 和 Fama-French 等模型，多因子模型的优势在于它可以提供 更为完整的风险暴露分析，并且分离出每个因子的影响,从而为投资决策提供 更为局部和细致的分析。 







作为量化选股多因子𝐴𝑙𝑝ℎ𝑎模型构建环节中最重要的一部分，如何寻找具有逻辑支撑且能有效区分和预测股票收益的因子是主要内容。 

 ![量化基础知识02](https://github.com/Miya-Su/Quantitative-Trading/tree/miya/image/量化基础知识02.png)



大部分机构投资者主要研究Alpha模型，风险模型和组合优化采用外购商业软件（BARRA,Axioma等）



风险模型：任意股票同一时刻都暴露于多种不同的风险因素下，它们之间的共同作用形成了股票价格的波动，为了定量研究各种风险因素的作用，量化风险模型应运而生。

风险模型的意义在于找到股票价格波动的成因，并将股票收益来源进行剥离，并实行对未来股票波动价格的预测。

Alpha因子：是对股票收益率具有明显显著且稳定影响的某一变量，同时该影响是剔除其余所有因子对收益的作用而独立存在的。

“群众型”:更符合分散风险的量化投资基本原理，大型的Alpha因子库在提供多样的Alpha源的而同时，也带来了大量的无效和重复信息，会使得不同的Alpha源被人为的放大或缩小权重，最终影响组合表现。

对于一个新的因子，需要思考：是否提供了新的Alpha源？或只是把现有的因子库信息进行了切分重组？



对于因子相关性检验：IC协方差矩阵的估计（改进:压缩估计量、Boostrap方法）







量化对冲策略目标：追求稳健的绝对收益，最优投资组合的构建是一种完美的平衡状态（充分暴露Alpha因子，同时剔除其余不稳定的风格因素干扰）

市值中性、行业中性、风格中性的约束条件下的最优投资组合的构建

 

行业中性:多头组合的行业配置与对冲基准的行业配置一致，目的在于剔除行业因子对策略收益的影响，仅考察行业内部个股的超额收益。（行业中性策略的净值曲线往往比较平稳，回测较小）

 

风格因子中性:多头组合的风格因子较之对冲基准的风险暴露为0，目的在于使多头组合的风格特征完全与对冲基准相匹配，使得组合的超额收益不是来自于某类风格

 

多因子模型：决定策略收益稳健性的关键步骤在于股票组合的权重配置。（组合权重优化）







## 去极值（异常值处理）



1. 均值方差法3σ：求每个因子的的均值u和方差σ，大于u+3σ和小于u-3σ的值转化为u+3σ和u-3σ
   - 先计算因子的平均值u和标准差σ
   - 确认参数n（n=3时为3σ法），因子的合理范围为[X_mean-nσ，X_mean+nσ]
2. 绝对值差中位数法mad：计算所有因子与平均值之间的距离总和来检测离群值
   - 先找出所有因子的中位数X_meadian
   - 得到每一个因子与中位数的绝对偏差值Xi-X_meadian
   - 得到绝对偏差值的中位数mad，最后确定参数n，合理范围为[X_meadian-nmad，X_meadian+nmad]
3. 分位数法（箱型图）





## 因子中性化

原因：A股的行业轮动明显，行业热点之间切换迅速，并且A股小市值个股占比明显，高波动率高收益率

目的：

- 降低投资组合的波动性和回测
- 为了在用某一因子时能够剔除其他因素的影响，使得选出的股票更加分散，需要进行中性化处理
- 为了消除因子中的偏差和不必要的影响

对于因子来说，中性化主要考虑市场风险和行业风险。

行业中性:多头组合的行业配置与对冲基准的行业配置一致，目的在于剔除行业因子对策略收益的影响，仅考察行业内部个股的超额收益。（行业中性策略的净值曲线往往比较平稳，回测较小）

风格因子中性:多头组合的风格因子较之对冲基准的风险暴露为0，目的在于使多头组合的风格特征完全与对冲基准相匹配，使得组合的超额收益不是来自于某类风格

1. 行业中性化

   行业中性化一般采用两种方式处理

   - 简单的标准化法

     利用申万行业指数，将各个行业的因子进行标准化处理，即减去均值除以标准差

   - 回归取残差法

     将因子值作为y，行业哑变量作为x，进行线性回归，回归模型的残差即为行业中性化后的因子值

2. 市值中性化

   因为市值因子是连续的，采用回归残差法