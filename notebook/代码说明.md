# 代码说明



​												图1.1





代码一共分为四大部分(参见图1.1，图1.2)，详细说明见下，相关图片可以在image文件夹里查阅大图。

1. 数据读取

   - 六大类因子读取  <def read_factor_data(factors_name_list, trade_date_20d_series)>
   - 十个风险因子读取  <def risk_factor(alpha_factor_series)>

2. 空值填充  <def nonefill(data,date_list)>

3. 概率预测 

   -  <def reg_factor_concat(fill_alpha_factor_series,model,loop,date_list)>

   - <class AveragingModels(BaseEstimator, RegressorMixin, TransformerMixin)>

   - <class StackingAveragedModels(BaseEstimator, RegressorMixin, TransformerMixin)>

4. 因子分析

   - 因子T检验<def factor_test_T(factor_list,factor_name)>
   - 因子检测1  <def factor_analyse(name,factor)>
   - 因子检测2  <def factor_stock_choose(factor,num)>





​											图1.2



## 详细说明

*1.数据读取

每个特征值都按照Pandas的pickle形式存储在相应文件夹（数据通过SVN进行本地更新），一共分为六大类（factor_name_list = ['emotion', 'pricevol', 'mom', 'finance', 'valuation', 'alpha191']）

使用<def read_factor_data(factors_name_list, trade_date_20d_series)>读入每一类的所有特征值数据，合计116个。

每个特征数据都是Pandas DataFrame格式，index为股票代码，columns为日期，数据代表当期值，如下所示：

![1544153318810](C:\Users\yuanruyi\Desktop\Miya—Git\Quantitative-Trading\notebook\1544153318810.png)

使用<data_input(data,date_list,x)>将116个特征值组合成一个Pandas DataFrame格式，index为3619只股票代码，每一列代表一个特征所对应的数据，即columns为对应的116个特征，最后一列为日期date，倒数第二列为标签值rise_fall，倒数第三列trade_status为股票状态列（只选择为0的正常股票，其余非零状态股票为非正常股票，可能停牌，应该删除），最终 DataFrame构造如下：

![1544171413926](C:\Users\yuanruyi\Desktop\Miya—Git\Quantitative-Trading\notebook\1544171413926.png)

![1544171473330](C:\Users\yuanruyi\Desktop\Miya—Git\Quantitative-Trading\notebook\1544171473330.png)